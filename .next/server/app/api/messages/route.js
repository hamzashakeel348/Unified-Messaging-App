"use strict";(()=>{var e={};e.id=217,e.ids=[217],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6346:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>_,requestAsyncStorage:()=>c,routeModule:()=>g,serverHooks:()=>h,staticGenerationAsyncStorage:()=>y});var n={};r.r(n),r.d(n,{GET:()=>m,dynamic:()=>d,runtime:()=>l});var i=r(9303),o=r(8716),a=r(670),s=r(7070),p=r(5748),u=r(9312);let l="nodejs",d="force-dynamic";async function m(e){let{searchParams:t}=new URL(e.url),r=t.get("platform");await (0,p.C)();let n={};("google"===r||"linkedin"===r)&&(n.platform=r);let i=await u.Z.find(n).sort({created_at:-1}).limit(100).lean();return s.NextResponse.json({messages:i})}let g=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/messages/route",pathname:"/api/messages",filename:"route",bundlePath:"app/api/messages/route"},resolvedPagePath:"/Users/hamzashakeel/Desktop/unipile-inbox-mvp-webhooks/src/app/api/messages/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:c,staticGenerationAsyncStorage:y,serverHooks:h}=g,v="/api/messages/route";function _(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:y})}},5748:(e,t,r)=>{r.d(t,{C:()=>s});var n=r(1185),i=r.n(n);let o=process.env.MONGODB_URI;if(!o)throw Error("Missing MONGODB_URI");let a=global._mongoose;async function s(){return a.conn||(a.promise||(a.promise=i().connect(o,{dbName:"unipile_inbox_mvp"}).then(e=>e)),a.conn=await a.promise),a.conn}a||(a=global._mongoose={conn:null,promise:null})},9312:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(1185);let i=new n.Schema({platform:{type:String,enum:["google","linkedin"],required:!0},account_id:{type:String},message_id:{type:String,required:!0,unique:!0},provider_message_id:{type:String},chat_id:{type:String},email_id:{type:String},from:{type:String,required:!0},to:{type:String,required:!0},subject:{type:String},text:{type:String},created_at:{type:Date,default:Date.now}},{timestamps:!0}),o=n.models.Message||(0,n.model)("Message",i)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972],()=>r(6346));module.exports=n})();