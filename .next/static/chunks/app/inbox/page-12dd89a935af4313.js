(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[840],{2354:function(e,s,t){Promise.resolve().then(t.bind(t,6646))},6646:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return n}});var a=t(7437),l=t(2265);function n(){let[e,s]=(0,l.useState)([]),[t,n]=(0,l.useState)("all"),[c,i]=(0,l.useState)(null),[r,o]=(0,l.useState)("");(0,l.useEffect)(()=>{(async()=>{let e=await fetch("all"===t?"/api/messages":"/api/messages?platform=".concat(t));s((await e.json()).messages||[])})()},[t]);let d=async()=>{if(!c)return;let e={platform:c.platform,text:r};"linkedin"===c.platform?e.chat_id=c.chat_id:(e.account_id=c.account_id,e.reply_to=c.provider_message_id,e.subject=c.subject?"Re: ".concat(c.subject):"(no subject)");let s=await fetch("/api/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await s.json();alert(t.ok?"Sent!":t.error||"Failed"),t.ok&&o("")};return(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("aside",{className:"card sidebar",children:[(0,a.jsx)("h3",{children:"Filters"}),(0,a.jsxs)("div",{className:"col",children:[(0,a.jsx)("button",{className:"btn ghost",onClick:()=>n("all"),children:"All"}),(0,a.jsx)("button",{className:"btn ghost",onClick:()=>n("google"),children:"Gmail"}),(0,a.jsx)("button",{className:"btn ghost",onClick:()=>n("linkedin"),children:"LinkedIn"})]}),(0,a.jsx)("p",{style:{color:"#94a3b8",marginTop:16},children:"Click a message to preview and reply."})]}),(0,a.jsxs)("main",{className:"card",style:{flex:1},children:[(0,a.jsx)("h3",{children:"Messages"}),(0,a.jsxs)("div",{className:"list",children:[e.map(e=>{var s;return(0,a.jsxs)("div",{className:"item",onClick:()=>i(e),style:{cursor:"pointer"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)("strong",{children:e.subject||(null===(s=e.text)||void 0===s?void 0:s.slice(0,60))||"(no subject)"}),(0,a.jsx)("small",{children:e.platform})]}),(0,a.jsxs)("small",{children:["From: ",e.from," â†’ ",e.to]})]},e._id)}),0===e.length&&(0,a.jsx)("p",{children:"No messages yet. Connect accounts and send yourself a test."})]})]}),(0,a.jsxs)("section",{className:"card sidebar",children:[(0,a.jsx)("h3",{children:"Preview"}),c?(0,a.jsxs)("div",{className:"col",children:[(0,a.jsx)("div",{children:(0,a.jsx)("small",{children:new Date(c.created_at).toLocaleString()})}),c.subject&&(0,a.jsx)("div",{children:(0,a.jsx)("strong",{children:c.subject})}),(0,a.jsx)("div",{className:"message",children:c.text}),(0,a.jsx)("textarea",{value:r,onChange:e=>o(e.target.value),rows:6,placeholder:"Type a reply..."}),(0,a.jsx)("button",{className:"btn",onClick:d,children:"Send"})]}):(0,a.jsx)("p",{children:"Select a message"})]})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2354)}),_N_E=e.O()}]);